<!DOCTYPE html>
{% extends 'base.html' %}
{% block content %}

        <style>
           #map {
            height: 600px;
            width: 100%;
           }
        </style>
      <div id="map"></div>
    <script>

      var map, infoWindow;
      var locations = [
        ['Bondi', 14.0902322, 100.6185316, 4],
        ['Coogee ', 14.0732099, 100.6144063, 5],
        ['Cronulla ', 14.0809367, 100.5935035, 3],
        ['Manly ', 14.0569173, 100.5979667, 2],
        ['Maroubra ', 14.0907186, 100.5935893, 1]
        ];

      var successHandler = function(position) {
      alert(position.coords.latitude);
      alert(position.coords.longitude);
      };

      var errorHandler = function (errorObj) {
      alert(errorObj.code + ": " + errorObj.message);

      alert("something wrong take this lat " + 26.0546106 );
      alert("something wrong take this lng " +-98.3939791);

      };




      function initMap() {

        //init map
        map = new google.maps.Map(document.getElementById('map'), {
          center: {lat: -34.397, lng: 150.644},
          zoom: 14
        });
        infoWindow = new google.maps.InfoWindow({
          content: '<IMG BORDER="0" ALIGN="Left" SRC="http://cmtcarsupermarket.co.uk/wp-content/uploads/2016/09/12-Month-Breakdown.png">'
        });

        // get current location
        if (navigator.geolocation) {

           navigator.geolocation.getCurrentPosition(function(position) {


                var pos = {
                  lat: position.coords.latitude,
                  lng: position.coords.longitude
                };

                console.log(pos);

                infoWindow.setPosition(pos);
                infoWindow.setContent("You here")
                infoWindow.open(map);
                map.setCenter(pos);
              }, function() {
                  handleLocationError(true, infoWindow, map.getCenter());
                });
          } else {
            // Browser doesn't support Geolocation
            handleLocationError(false, infoWindow, map.getCenter());
          }

          //marker

          var marker, i;

          infoCradle = new google.maps.InfoWindow();


          for (i = 0; i < locations.length; i++) {
              marker = new google.maps.Marker({position: new google.maps.LatLng(locations[i][1], locations[i][2]),
              map: map
            });

            google.maps.event.addListener(marker, 'click', (function(marker, i) {
              return function() {
                infoCradle.setContent(locations[i][0]+ '<button onclick="myFunction()">Deal</button>');
                infoCradle.open(map, marker);
              }
            })(marker, i));
          }


      }


      function handleLocationError(browserHasGeolocation, infoWindow, pos) {
        posFix = {lat: 14.065574699999999, lng: 100.6057261};
        //infoWindow.setPosition(posFix);

        infoWindow.setContent(browserHasGeolocation ?
                              'Error: The Geolocation service failed.' :
                              'Error: Your browser doesn\'t support geolocation.');
        infoWindow.setContent("You here")
        infoWindow.open(map);
      }



        </script>
        <script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?sensor=false"></script>
        <script async defer
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyABtz7sfkMygVwWaTmKt474Lio37dou6c0&callback=initMap">
        </script>

{% endblock %}
